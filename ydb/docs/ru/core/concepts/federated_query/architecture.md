# Aрхитектура федеративных запросов

Для реализации федеративных запросов {{ ydb-full-name }} необходимо отправлять запросы в сторонние системы хранения данных; для этого приходится использовать их клиентские библиотеки. Появление таких зависимостей негативно сказывается на объёме кодовой базы, времени компиляции и размере бинарных файлов {{ ydb-short-name }}, а также на стабильности всего продукта в целом.

Перечень поддерживаемых источников данных для федеративных запросов постоянно расширяется. 
Наиболее популярные источники, такие как [S3](s3), поддерживаются {{ ydb-short-name }} нативно. Однако не всем пользователям требуется поддержка одновременно всех источников. Её можно включить опционально с помощью  _коннекторов_ - специальных микросервисов, реализующих унифицированный интерфейс доступа к внешним источникам данных.

## Коннекторы {#connectors}

В функции коннекторов входят:

* Трансляция YQL-запросов в запросы на языке, специфичном для внешнего источника (например, в запросы на другом диалекте SQL или в обращения к HTTP API).
* Организация сетевых соединений с источниками данных.
* Конвертация данных, извлечённых из внешних источников, в колоночное представление в формате [Arrow IPC Stream](https://arrow.apache.org/docs/format/Columnar.html#serialization-and-interprocess-communication-ipc), поддерживаемом {{ ydb-short-name }}.

![Архитектура YDB Federated Query](_assets/architecture.png "Архитектура YDB Federated Query" =640x)

Таким образом, благодаря коннекторам формируется слой абстракции, скрывающий от {{ ydb-short-name }} специфику внешних источников данных. Лаконичность интерфейса коннектора позволяет легко расширять перечень поддерживаемых источников, внося минимальные изменения в код {{ ydb-short-name }}.

Пользователи могут развернуть [один из готовых коннекторов](../../deploy/manual/connector.md) или написать свою реализацию на любом языке программирования по [gRPC спецификации](https://github.com/ydb-platform/ydb/tree/main/ydb/library/yql/providers/generic/connector/api).

## Перечень поддерживаемых внешних источников данных {#supported-datasources}

| Источник | Поддержка |
| -------- | --------- |
| [S3](https://aws.amazon.com/ru/s3/) | Нативная |
| [ClickHouse](https://clickhouse.com/) | Через коннектор [fq-connector-go](../../deploy/manual/connector.md#fq-connector-go) |
| [PostgreSQL](https://www.postgresql.org/) | Через коннектор [fq-connector-go](../../deploy/manual/connector.md#fq-connector-go) |
